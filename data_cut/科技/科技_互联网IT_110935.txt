八核融合时代：国产x86处理器最新成果抢先看　　（原标题：走进八核心融合时代：国产x86处理器最新成果抢先看）　　说到在个人电脑中应用最广泛的x86处理器，可能大家首先想到的就是那两家美国公司的产品，似乎没有其他哪一个国家有能力敢在这个领域挑战，除了中国。事实上早在2014年我国的x86处理器就已发布，并在短短几年内获得了高速发展—从双核心、四核心到现在的SOC八核心设计；从只能进行简单的办公应用，到全高清影音播放，再到与HTC VIVE配合，为玩家提供流畅的VR体验，国产x86处理器发展所取得的成果绝对值得每一位国人关注。　　我们曾率先报道了国产x86处理器的发展情况，并通过后续一系列实际产品报道、评测可以看到，虽然与国外x86处理器还有一定差距，但当前的兆芯开先ZX-C四核心处理器已经具备流畅运行WORD、PowerPoint各类办公软件，播放全高清视频，运行《英雄联盟》这类主流网游的能力。那么时隔大半年后，国产x86处理器又有什么新的进展呢？在近期举办的北京国际互联网科技博览会暨世界网络安全大会上，上海兆芯集成电路有限公司为我们带来了新的惊喜。　　首款国产全融合x86：8核心处理器亮相　　在本次兆芯展台上，最抢眼的主角应该就是首次登台亮相、核心架构名为“五道口”的兆芯ZX-D处理器，这款处理器目前有四核心、八核心两个版本。虽然在之前基于“张江”核心架构的兆芯ZX-C处理器上，兆芯也推出了8核心设计的兆芯开胜ZX-C+处理器，但ZX-D处理器在架构上却进行了很大的改进。　　在之前的ZX-C+8核心处理器上，它的结构是由两个ZX-C四核心处理器封装在一起，在外观上我们可以看到其PCB基板上有两颗小核心。而ZX-D处理器则原生采用了四核心或八核心设计，并将内存控制器、PCIe控制器全部融入到芯片内部，也就是采用了SoC(System-on-Chip)设计，其外观就是一个大大的核心。这样的设计可以为ZX-D处理器带来诸多好处。　　首先兆芯对ZX-D处理器内核的流水线进行了重新设计，其中ZX-D处理器的整数流水线相比ZX-C大幅减少了分支预测失败的开销，同频性能更强，并保持工作频率不变而核心面积和功耗仅略微增加。此外CPU的L1及内存访问都实现了带宽翻倍，并在末级缓存引入了先进的替换算法，在相同缓存容量的情况下可大幅减少某些应用程序的缓存缺失率。同时，ZX-D处理器缓存的性能与容量均有了很大提升。　　在兆芯x86处理器中，每四颗处理器核心共享一部分缓存。在ZX-C+8核心处理器中，每四颗核心共享2MB缓存，总计4MB缓存。然而问题也来了，多核心处理器在工作时需要确保各个核心所能“看”到的缓存内容一致，知道哪个数据被改写了，哪个任务该由哪颗核心来执行，避免冲突，实现效率最大化，因此就需要时刻同步，以保持缓存一致性。但ZX-C+处理器只是一颗单纯的运算核心，要让每个四核模块中的缓存保持一致性，就需要将这个协调工作交给外部的北桥芯片—两个四核心模块需要同步更新处理器内缓存的数据时，将由FSB前端总线传输到北桥作更新。虽然缓存的数据量并不巨大，但由于需要通过北桥进行处理，无疑会带来一定的延迟，核心之间的通信就会变得缓慢，这将在一定程度上影响处理器性能的发挥。　　而在ZX-D 8核心处理器中，它不仅提升了缓存容量，每四颗核心共享4MB缓存，总计拥有8MB缓存。更重要的是，处理器与北桥的完全融合，使得其缓存数据的一致性直接在处理器内部就可以完成。这也就意味着处理器之间的交互不用再通过北桥，而是使用片内高速点对点直连网络互联，降低了延迟并提高了带宽，为将来更多核心的互联提供了基础（有点类似ZEN架构）。　　其次内存控制器、PCIe控制器的融合也可以大大提升内存与显卡性能。在南北桥架构中，内存、显卡都必须通过北桥由FSB前端总线将数据传输给处理器。但问题是在ZX-C平台中，FSB前端总线频率只有1333MHz，总线带宽也就在10.6GB/s左右。而当今双通道DDR4 2133的内存带宽早已超过30GB/s，PCIe 3.0 x16显卡的带宽也达到16GB/s。所以前端总线使得ZX-C处理器已经无法很好地与最新硬件配合，发挥出各自的最大性能。因此在ZX-D处理器中，它在处理器内部整合了内存控制器（DDR4内存控制器，也使得兆芯ZX-D成为国产处理器中首个支持DDR4内存的产品）与PCIe控制器，处理器可通过内部的高带宽直连总线访问内存、显卡。其中内存访问带宽提升了1～2倍，有效地发挥出了DDR4内存的优势，对于处理器多核及多线程应用有显著的提升。　　▲以英特尔P35芯片组为例，在这类南北桥架构平台中CPU都需要通过北桥、前端总线与显卡、内存进行通信，不仅其带宽被限制，通讯延迟也大为增加。　　此外，ZX-D处理器还在内部集成了新一代图形核心。虽然其具体规格还未披露，但从架构上我们就不难看出，相比ZX-C集成在北桥中的图形核心，在CPU内部集成图形核心首先可以降低处理器与图形核心之间的通信延迟，提升渲染效率。更重要的是，相对于ZX-C平台被限制在10.6GB/s以内的内存带宽，图形核心可以有效利用DDR4内存提供的高带宽优势，等同于大幅提升了显存带宽，集显核心性能将得到提升。　　▲兆芯开先、开胜ZX-D处理器在架构上更类似于当前的英特尔酷睿处理器，PCIe控制器、DDR4内存控制器全部集成在处理器中，直接与处理器通讯，仅需一个提供存储功能与PCIe通道的IOE扩展芯片与它搭配。　　经过以上一系列改进，目前根据兆芯的官方数据来看，在保持和开先ZX-C系列处理器工作频率不变的前提下，兆芯ZX-D系列处理器比开先ZX-C系列处理器在整数单任务运算性能上有20%左右的提升，在整数多任务运算性能上的提升更是接近50%。最后兆芯开胜ZX-D 8核心处理器的SPEC2006多任务整数运算成绩达到111分。其8核心产品整体性能达到Skylake核心的英特尔Core i3桌面版处理器，其8核心产品具体成绩如下：　　兆芯开胜ZX-D 8核心处理器测试成绩　　SPEC2006单任务 多任务　　整数性能20.2 111　　浮点性能24.8 73.1